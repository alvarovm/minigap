Logging all output starting now into /home/sstafford/Documents/Python/miniGAP/minigap/results/distorted_propenol_12_06_2021/miniGAP.log
Input settings for this calculation stored in /home/sstafford/Documents/Python/miniGAP/minigap/results/distorted_propenol_12_06_2021/miniGAP.settings
Stack size set to unlimited
1 GPU(s) recognized by tensorflow: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Imported 600 structures from /home/sstafford/Documents/Python/miniGAP/minigap/data/distorted_propenol.db. Structures were taken uniformly from throughout dataset which contains 2000 total structures.
Compiling structures into list took 0.78 seconds
Generating animation frame 0 (0% complete)
Generating animation frame 10 (10% complete)
Generating animation frame 20 (20% complete)
Generating animation frame 30 (30% complete)
Generating animation frame 40 (40% complete)
Generating animation frame 50 (50% complete)
Generating animation frame 60 (60% complete)
Generating animation frame 70 (70% complete)
Generating animation frame 80 (80% complete)
Generating animation frame 90 (90% complete)
Generating animation frame 100 (100% complete)
Filename '/home/sstafford/Documents/Python/miniGAP/minigap/results/distorted_propenol_12_06_2021/structure_animation.mp4' selected.
Generating animation frame 0 (0% complete)
Generating animation frame 10 (10% complete)
Generating animation frame 20 (20% complete)
Generating animation frame 30 (30% complete)
Generating animation frame 40 (40% complete)
Generating animation frame 50 (50% complete)
Generating animation frame 60 (60% complete)
Generating animation frame 70 (70% complete)
Generating animation frame 80 (80% complete)
Generating animation frame 90 (90% complete)
Generating animation frame 100 (100% complete)
Created animation of the structural dataset used in this calculation in the results directory. This might be useful to verify the correct structures are being used.
Created animation of structures in 4.461912393569946 seconds 
Gathered energy, force and structure info in 1.14 seconds
Completed the initial setup of miniGAP (including compiling structural data) in 8.71 seconds
Generated SOAP descriptors and derivatives in 12.27 seconds
Reformatted data to build model in 0.11 seconds.
Not using any sparsity.
Using a degree 2 polynomial kernel.
Alert: Double check the training validity for degree =/= 1 when not using predict_f
Training using 4860 atoms without batching.
Epoch 0
Using older approach (not converted to tf.function yet)
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+---------------------------------------+
| name                    | class            | transform        | prior   | trainable   | shape        | dtype   | value                                 |
+=========================+==================+==================+=========+=============+==============+=========+=======================================+
| GPR.kernel.variance     | Parameter        | Softplus         |         | True        | ()           | float64 | 1.0003877577437326                    |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+---------------------------------------+
| GPR.kernel.degree       | Parameter        | Identity         |         | False       | ()           | float64 | 2.0                                   |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+---------------------------------------+
| GPR.kernel.offset       | Parameter        | Softplus         |         | False       | ()           | float64 | 2.2250738585072626e-308               |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+---------------------------------------+
| GPR.likelihood.variance | Parameter        | Softplus + Shift |         | True        | ()           | float64 | 9.99521476365529e-05                  |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+---------------------------------------+
| GPR.data[0]             | ResourceVariable |                  |         | False       | (4860, 1500) | float64 | [[0.543163, 0.52528842, 0.32825139... |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+---------------------------------------+
| GPR.data[1]             | ResourceVariable |                  |         | False       | (4860, 1)    | float64 | [[-0.69600722...                      |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+---------------------------------------+
Adding mse_ens_j_i to mse_ens_j: 3.9863853378609083e-07 + 0 = 3.9863853378609083e-07 
Epoch 0,  mse = 3.9863853378609083e-07
Using older approach (not converted to tf.function yet)
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------+
| name                    | class            | transform        | prior   | trainable   | shape        | dtype   | value                                   |
+=========================+==================+==================+=========+=============+==============+=========+=========================================+
| GPR.kernel.variance     | Parameter        | Softplus         |         | True        | ()           | float64 | 1.0009290570403677                      |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------+
| GPR.kernel.degree       | Parameter        | Identity         |         | False       | ()           | float64 | 2.0                                     |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------+
| GPR.kernel.offset       | Parameter        | Softplus         |         | False       | ()           | float64 | 2.2250738585072626e-308                 |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------+
| GPR.likelihood.variance | Parameter        | Softplus + Shift |         | True        | ()           | float64 | 9.988522110068615e-05                   |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------+
| GPR.data[0]             | ResourceVariable |                  |         | False       | (4860, 1500) | float64 | [[0.00150412, 0.0074967, -0.00554944... |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------+
| GPR.data[1]             | ResourceVariable |                  |         | False       | (4860, 1)    | float64 | [[0.58258929...                         |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------+
Adding mse_ens_j_i to mse_ens_j: 3.985393253568094e-07 + 0 = 3.985393253568094e-07 
Epoch 1,  mse = 3.985393253568094e-07
Epoch 2
Using older approach (not converted to tf.function yet)
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| name                    | class            | transform        | prior   | trainable   | shape        | dtype   | value                                               |
+=========================+==================+==================+=========+=============+==============+=========+=====================================================+
| GPR.kernel.variance     | Parameter        | Softplus         |         | True        | ()           | float64 | 1.0015854336394425                                  |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.kernel.degree       | Parameter        | Identity         |         | False       | ()           | float64 | 2.0                                                 |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.kernel.offset       | Parameter        | Softplus         |         | False       | ()           | float64 | 2.2250738585072626e-308                             |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.likelihood.variance | Parameter        | Softplus + Shift |         | True        | ()           | float64 | 9.980398532768661e-05                               |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.data[0]             | ResourceVariable |                  |         | False       | (4860, 1500) | float64 | [[5.38554412e-01, 5.41297148e-01, 2.27639938e-01... |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.data[1]             | ResourceVariable |                  |         | False       | (4860, 1)    | float64 | [[-0.7038314...                                     |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
Adding mse_ens_j_i to mse_ens_j: 3.984008442550476e-07 + 0 = 3.984008442550476e-07 
Epoch 2,  mse = 3.984008442550476e-07
Using older approach (not converted to tf.function yet)
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| name                    | class            | transform        | prior   | trainable   | shape        | dtype   | value                                               |
+=========================+==================+==================+=========+=============+==============+=========+=====================================================+
| GPR.kernel.variance     | Parameter        | Softplus         |         | True        | ()           | float64 | 1.0023369872245937                                  |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.kernel.degree       | Parameter        | Identity         |         | False       | ()           | float64 | 2.0                                                 |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.kernel.offset       | Parameter        | Softplus         |         | False       | ()           | float64 | 2.2250738585072626e-308                             |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.likelihood.variance | Parameter        | Softplus + Shift |         | True        | ()           | float64 | 9.971092524606789e-05                               |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.data[0]             | ResourceVariable |                  |         | False       | (4860, 1500) | float64 | [[5.40155871e-01, 5.40347463e-01, 2.18253724e-01... |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.data[1]             | ResourceVariable |                  |         | False       | (4860, 1)    | float64 | [[-0.69709127...                                    |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
Adding mse_ens_j_i to mse_ens_j: 3.982330319200887e-07 + 0 = 3.982330319200887e-07 
Epoch 3,  mse = 3.982330319200887e-07
Epoch 4
Using older approach (not converted to tf.function yet)
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+------------------------------------------------------+
| name                    | class            | transform        | prior   | trainable   | shape        | dtype   | value                                                |
+=========================+==================+==================+=========+=============+==============+=========+======================================================+
| GPR.kernel.variance     | Parameter        | Softplus         |         | True        | ()           | float64 | 1.0031709974393213                                   |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+------------------------------------------------------+
| GPR.kernel.degree       | Parameter        | Identity         |         | False       | ()           | float64 | 2.0                                                  |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+------------------------------------------------------+
| GPR.kernel.offset       | Parameter        | Softplus         |         | False       | ()           | float64 | 2.2250738585072626e-308                              |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+------------------------------------------------------+
| GPR.likelihood.variance | Parameter        | Softplus + Shift |         | True        | ()           | float64 | 9.960764291672238e-05                                |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+------------------------------------------------------+
| GPR.data[0]             | ResourceVariable |                  |         | False       | (4860, 1500) | float64 | [[1.46339106e-03, 2.46141016e-03, -4.53510728e-03... |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+------------------------------------------------------+
| GPR.data[1]             | ResourceVariable |                  |         | False       | (4860, 1)    | float64 | [[2.45287557...                                      |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+------------------------------------------------------+
Adding mse_ens_j_i to mse_ens_j: 3.980410833911631e-07 + 0 = 3.980410833911631e-07 
Epoch 4,  mse = 3.980410833911631e-07
Using older approach (not converted to tf.function yet)
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| name                    | class            | transform        | prior   | trainable   | shape        | dtype   | value                                               |
+=========================+==================+==================+=========+=============+==============+=========+=====================================================+
| GPR.kernel.variance     | Parameter        | Softplus         |         | True        | ()           | float64 | 1.0040784196272103                                  |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.kernel.degree       | Parameter        | Identity         |         | False       | ()           | float64 | 2.0                                                 |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.kernel.offset       | Parameter        | Softplus         |         | False       | ()           | float64 | 2.2250738585072626e-308                             |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.likelihood.variance | Parameter        | Softplus + Shift |         | True        | ()           | float64 | 9.94952877640453e-05                                |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.data[0]             | ResourceVariable |                  |         | False       | (4860, 1500) | float64 | [[5.42268755e-01, 5.26775968e-01, 3.18436551e-01... |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.data[1]             | ResourceVariable |                  |         | False       | (4860, 1)    | float64 | [[-0.70345951...                                    |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
Adding mse_ens_j_i to mse_ens_j: 3.9782835715225e-07 + 0 = 3.9782835715225e-07 
Epoch 5,  mse = 3.9782835715225e-07
Epoch 6
Using older approach (not converted to tf.function yet)
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| name                    | class            | transform        | prior   | trainable   | shape        | dtype   | value                                               |
+=========================+==================+==================+=========+=============+==============+=========+=====================================================+
| GPR.kernel.variance     | Parameter        | Softplus         |         | True        | ()           | float64 | 1.0050523879408533                                  |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.kernel.degree       | Parameter        | Identity         |         | False       | ()           | float64 | 2.0                                                 |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.kernel.offset       | Parameter        | Softplus         |         | False       | ()           | float64 | 2.2250738585072626e-308                             |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.likelihood.variance | Parameter        | Softplus + Shift |         | True        | ()           | float64 | 9.937474042308375e-05                               |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.data[0]             | ResourceVariable |                  |         | False       | (4860, 1500) | float64 | [[5.37035021e-01, 5.37273948e-01, 2.81296452e-01... |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.data[1]             | ResourceVariable |                  |         | False       | (4860, 1)    | float64 | [[-0.69600722...                                    |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
Adding mse_ens_j_i to mse_ens_j: 3.9759726843551004e-07 + 0 = 3.9759726843551004e-07 
Epoch 6,  mse = 3.9759726843551004e-07
Using older approach (not converted to tf.function yet)
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+----------------------------------------+
| name                    | class            | transform        | prior   | trainable   | shape        | dtype   | value                                  |
+=========================+==================+==================+=========+=============+==============+=========+========================================+
| GPR.kernel.variance     | Parameter        | Softplus         |         | True        | ()           | float64 | 1.0060874525282735                     |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+----------------------------------------+
| GPR.kernel.degree       | Parameter        | Identity         |         | False       | ()           | float64 | 2.0                                    |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+----------------------------------------+
| GPR.kernel.offset       | Parameter        | Softplus         |         | False       | ()           | float64 | 2.2250738585072626e-308                |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+----------------------------------------+
| GPR.likelihood.variance | Parameter        | Softplus + Shift |         | True        | ()           | float64 | 9.92467064625626e-05                   |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+----------------------------------------+
| GPR.data[0]             | ResourceVariable |                  |         | False       | (4860, 1500) | float64 | [[0.5447331, 0.52278361, 0.33627324... |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+----------------------------------------+
| GPR.data[1]             | ResourceVariable |                  |         | False       | (4860, 1)    | float64 | [[-0.70370536...                       |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+----------------------------------------+
Adding mse_ens_j_i to mse_ens_j: 3.973496735697619e-07 + 0 = 3.973496735697619e-07 
Epoch 7,  mse = 3.973496735697619e-07
Epoch 8
Using older approach (not converted to tf.function yet)
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+------------------------------------------------------+
| name                    | class            | transform        | prior   | trainable   | shape        | dtype   | value                                                |
+=========================+==================+==================+=========+=============+==============+=========+======================================================+
| GPR.kernel.variance     | Parameter        | Softplus         |         | True        | ()           | float64 | 1.007179144221258                                    |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+------------------------------------------------------+
| GPR.kernel.degree       | Parameter        | Identity         |         | False       | ()           | float64 | 2.0                                                  |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+------------------------------------------------------+
| GPR.kernel.offset       | Parameter        | Softplus         |         | False       | ()           | float64 | 2.2250738585072626e-308                              |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+------------------------------------------------------+
| GPR.likelihood.variance | Parameter        | Softplus + Shift |         | True        | ()           | float64 | 9.911176989118837e-05                                |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+------------------------------------------------------+
| GPR.data[0]             | ResourceVariable |                  |         | False       | (4860, 1500) | float64 | [[1.68622382e-03, 7.98690572e-03, -7.66740064e-03... |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+------------------------------------------------------+
| GPR.data[1]             | ResourceVariable |                  |         | False       | (4860, 1)    | float64 | [[0.59784495...                                      |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+------------------------------------------------------+
Adding mse_ens_j_i to mse_ens_j: 3.970870642551283e-07 + 0 = 3.970870642551283e-07 
Epoch 8,  mse = 3.970870642551283e-07
Using older approach (not converted to tf.function yet)
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+------------------------------------------+
| name                    | class            | transform        | prior   | trainable   | shape        | dtype   | value                                    |
+=========================+==================+==================+=========+=============+==============+=========+==========================================+
| GPR.kernel.variance     | Parameter        | Softplus         |         | True        | ()           | float64 | 1.0083237055445067                       |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+------------------------------------------+
| GPR.kernel.degree       | Parameter        | Identity         |         | False       | ()           | float64 | 2.0                                      |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+------------------------------------------+
| GPR.kernel.offset       | Parameter        | Softplus         |         | False       | ()           | float64 | 2.2250738585072626e-308                  |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+------------------------------------------+
| GPR.likelihood.variance | Parameter        | Softplus + Shift |         | True        | ()           | float64 | 9.897042623381174e-05                    |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+------------------------------------------+
| GPR.data[0]             | ResourceVariable |                  |         | False       | (4860, 1500) | float64 | [[0.00211734, 0.00254095, -0.00764961... |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+------------------------------------------+
| GPR.data[1]             | ResourceVariable |                  |         | False       | (4860, 1)    | float64 | [[2.45367865...                          |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+------------------------------------------+
Adding mse_ens_j_i to mse_ens_j: 3.9681067905531066e-07 + 0 = 3.9681067905531066e-07 
Epoch 9,  mse = 3.9681067905531066e-07
Calculating weights
+-------------------------+-----------+------------------+---------+-------------+---------+---------+--------------+
| name                    | class     | transform        | prior   | trainable   | shape   | dtype   |        value |
+=========================+===========+==================+=========+=============+=========+=========+==============+
| GPR.kernel.variance     | Parameter | Softplus         |         | True        | ()      | float64 | 1.00832      |
+-------------------------+-----------+------------------+---------+-------------+---------+---------+--------------+
| GPR.kernel.degree       | Parameter | Identity         |         | False       | ()      | float64 | 2            |
+-------------------------+-----------+------------------+---------+-------------+---------+---------+--------------+
| GPR.kernel.offset       | Parameter | Softplus         |         | False       | ()      | float64 | 2.22507e-308 |
+-------------------------+-----------+------------------+---------+-------------+---------+---------+--------------+
| GPR.likelihood.variance | Parameter | Softplus + Shift |         | True        | ()      | float64 | 9.89704e-05  |
+-------------------------+-----------+------------------+---------+-------------+---------+---------+--------------+
Predicting final energies
Predicting final forces
Training time outside of epochs in training cell  : 0.854
Training time per epoch                           : 0.493
Prediction time                                   : 0.094
Stored the hyperparameters and mse values for plotting under n=600
The title axes are not assigned correctly. Currently fixing.
Our observation noise variance implies our reference error is +/- 0.244 /atom
                         Local Energy  Global Energy
Root Mean Squared Error      0.023588       0.011660
Mean Absolute Error          0.012115       0.007854
Max Absolute Error           0.278598       0.055016
r²                           1.000000       0.993662
Least-squares regresion for Fx(x) produces the line line m x+b with m = 1.18261 and b = -0.00926 which has r2 = 0.83737 
Least-squares regresion for Fy(y) produces the line line m y+b with m = 1.13908 and b = 0.02176 which has r2 = 0.78276 
Least-squares regresion for Fz(z) produces the line line m z+b with m = 1.01893 and b = 0.01138 which has r2 = 0.82053 
