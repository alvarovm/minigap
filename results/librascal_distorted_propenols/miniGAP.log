

░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
░░███████████████████████████████████████████████████████████████████████████░░
░░██████████████████████████████████           ██████     ██████           ██░░
░░██████████████████████████████████   █████   ████         ████   █████   ██░░
░░██████████████████████████████████   █████   ███    ███    ███   █████   ██░░
░░██████████████████████████████████   ███████████   █████   ███   █████   ██░░
░░██████████████████████████████████   ███████████   █████   ███           ██░░
░░███████████████  ████████████  ███   ███     ███           ███   ██████████░░
░░██          ████████      ████████   █████   ███   █████   ███   ██████████░░
░░██  ██  ██  ███  ███  ██  ███  ███   █████   ███   █████   ███   ██████████░░
░░██  ██  ██  ███  ███  ██  ███  ███           ███   █████   ███   ██████████░░
░░███████████████████████████████████████████████████████████████████████████░░
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
░░░░░                                                                     ░░░░░
░░░░░  version 0.0.1                                                      ░░░░░
░░░░░                                                                     ░░░░░
░░░░░  script created on 2021/12/17                                       ░░░░░
░░░░░                                                                     ░░░░░
░░░░░  GitHub Repository HTTPS://GITHUB.COM/ALVAROVM/MINIGAP              ░░░░░
░░░░░                                                                     ░░░░░
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
░░░░░                                                                     ░░░░░
░░░░░  Authors                                                            ░░░░░
░░░░░                                                                     ░░░░░
░░░░░  Sean Stafford                                                      ░░░░░
░░░░░  Dr. Álvaro Vázquez-Mayagoitia                                      ░░░░░
░░░░░  Dr. Murat Keçeli                                                   ░░░░░
░░░░░  Dr. Jose L. Mendoza-Cortes                                         ░░░░░
░░░░░                                                                     ░░░░░
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
░░░░░                                                                     ░░░░░
░░░░░  Copyright 2021 Argonne UChicago LLC                                ░░░░░
░░░░░                                                                     ░░░░░
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░


Input settings for this calculation stored in /home/sstafford/Documents/Python/miniGAP/minigap/results/librascal_distorted_propenols/miniGAP.settings
Stack size set to unlimited
1 GPU(s) recognized by tensorflow: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Imported 1000 structures from distorted_propenol.db. Structures were taken uniformly from throughout dataset which contains 2000 total structures.
Compiling structures into list took 0.79 seconds
Generating animation frame 0 (0% complete)
Generating animation frame 10 (10% complete)
Generating animation frame 20 (20% complete)
Generating animation frame 30 (30% complete)
Generating animation frame 40 (40% complete)
Generating animation frame 50 (50% complete)
Generating animation frame 60 (60% complete)
Generating animation frame 70 (70% complete)
Generating animation frame 80 (80% complete)
Generating animation frame 90 (90% complete)
Generating animation frame 100 (100% complete)
Filename '/home/sstafford/Documents/Python/miniGAP/minigap/results/librascal_distorted_propenols/structure_animation.mp4' selected.
Generating animation frame 0 (0% complete)
Generating animation frame 10 (10% complete)
Generating animation frame 20 (20% complete)
Generating animation frame 30 (30% complete)
Generating animation frame 40 (40% complete)
Generating animation frame 50 (50% complete)
Generating animation frame 60 (60% complete)
Generating animation frame 70 (70% complete)
Generating animation frame 80 (80% complete)
Generating animation frame 90 (90% complete)
Generating animation frame 100 (100% complete)
Created animation of the structural dataset used in this calculation in the results directory. This might be useful to verify the correct structures are being used.
Created animation of structures in 5.08 seconds 
Gathered energy, force and structure info in 2.01 seconds
Completed the initial setup of miniGAP (including compiling structural data) in 10.52 seconds
Generated SOAP descriptors and derivatives in 13.27 seconds
Split the 1000-structure dataset into a 600-structure training dataset and a 400-structure test dataset.
The test dataset will be set aside until the model is trained and ready for prediction.
Reformatted data to build model in 0.11 seconds.
Not using any sparsity.
Using a degree 2 polynomial kernel.
Alert: Double check the training validity for degree =/= 1 when not using predict_f
Training using 5400 atoms without batching.
Calculating weights
+-------------------------+-----------+------------------+---------+-------------+---------+---------+--------------+
| name                    | class     | transform        | prior   | trainable   | shape   | dtype   |        value |
+=========================+===========+==================+=========+=============+=========+=========+==============+
| GPR.kernel.variance     | Parameter | Softplus         |         | True        | ()      | float64 | 1            |
+-------------------------+-----------+------------------+---------+-------------+---------+---------+--------------+
| GPR.kernel.degree       | Parameter | Identity         |         | False       | ()      | float64 | 2            |
+-------------------------+-----------+------------------+---------+-------------+---------+---------+--------------+
| GPR.kernel.offset       | Parameter | Softplus         |         | False       | ()      | float64 | 2.22507e-308 |
+-------------------------+-----------+------------------+---------+-------------+---------+---------+--------------+
| GPR.likelihood.variance | Parameter | Softplus + Shift |         | True        | ()      | float64 | 0.0001       |
+-------------------------+-----------+------------------+---------+-------------+---------+---------+--------------+
Predicting final energies
Predicting final forces
Training time outside of epochs in training cell  : 0.877
Prediction time                                   : 0.824
Stored the hyperparameters and mse values for plotting under n=1000
Our observation noise variance implies our reference error is +/- 0.246 /atom
Calculated the following error statistics: ('rmse', 'mae', 'mxae', 'r2', 'logvae', 'm', 'b')
Calculated the following error statistics: ('rmse', 'mae', 'mxae', 'r2', 'logvae', 'm', 'b')
Calculated the following error statistics: ('rmse', 'mae', 'mxae', 'r2', 'logvae', 'm', 'b')
Checking if outliers exists among energy predictions.
Outliers of error defined to exist outside the range (25th percentile - 1.5*25th-75th percentile range, 75th percentile + 1.5*25th-75th percentile range), i.e. (-0.29, 0.35).
Additionally, error was not considered an outlier if it fell outside that range, but was within 0.2 * 25th-75th percentile range ( = 0.03) of non-outlier error
9/400 error were found to be outliers.
Cropping energy plots determined to be unnecessary.
                               Global Energy Global Energy/Atom Local Energy
Units                                     eV            eV/Atom      eV/Atom
Root Mean Squared Error             0.184829           0.018483     0.033684
Mean Absolute Error                 0.122662           0.012266     0.019673
Max Absolute Error                  1.404924           0.140492     0.477203
r²                                  0.967491           0.967491     0.999998
Variance of Log Absolute Error      1.561611           1.561611     1.746197
Linear Fit Slope                    0.800687           0.800687     1.000008
Linear Fit y-Intercept            -57.889687          -5.788969     -0.00033
Filename '/home/sstafford/Documents/Python/miniGAP/minigap/results/librascal_distorted_propenols/energy_prediction_plots.png' selected.
Filename '/home/sstafford/Documents/Python/miniGAP/minigap/results/librascal_distorted_propenols/energy_errors.csv' selected.
Calculated the following error statistics: ('rmse', 'mae', 'mxae', 'r2', 'logvae', 'm', 'b')
Checking if outliers exists among Cartesian force components predictions.
Outliers of error defined to exist outside the range (25th percentile - 1.5*25th-75th percentile range, 75th percentile + 1.5*25th-75th percentile range), i.e. (-2.73, 2.84).
Additionally, error was not considered an outlier if it fell outside that range, but was within 0.2 * 25th-75th percentile range ( = 0.28) of non-outlier error
37/12000 error were found to be outliers.
Checking if outliers exists among force magnitude predictions.
Outliers of error defined to exist outside the range (25th percentile - 1.5*25th-75th percentile range, 75th percentile + 1.5*25th-75th percentile range), i.e. (-2.69, 5.58).
Additionally, error was not considered an outlier if it fell outside that range, but was within 0.2 * 25th-75th percentile range ( = 0.41) of non-outlier error
14/4000 error were found to be outliers.
Checking if outliers exists among force angle predictions.
Outliers of error defined to exist outside the range (25th percentile - 1.5*25th-75th percentile range, 75th percentile + 1.5*25th-75th percentile range), i.e. (-42.63, 42.23).
Additionally, error was not considered an outlier if it fell outside that range, but was within 0.2 * 25th-75th percentile range ( = 4.24) of non-outlier error
23/4000 error were found to be outliers.
                                       Fx         Fy        Fz        |F|          θ
Units                              eV/ang     eV/ang    eV/ang     eV/ang          °
Root Mean Squared Error          1.974731   2.028708  1.036235   2.595602  24.101512
Mean Absolute Error              1.343967   1.352455   0.69376   1.811752  16.454847
Max Absolute Error              15.751679  17.180994  7.513273  17.680342  137.98119
r²                               0.490775   0.426429  0.642991   0.302537   0.462898
Variance of Log Absolute Error   1.531449   1.634854  1.729536   1.542571    1.67149
Linear Fit Slope                 1.235025   1.499804  1.272943   0.930056   0.688396
Linear Fit y-Intercept           0.193879   0.066334 -0.000043   1.798395  27.877305
Filename '/home/sstafford/Documents/Python/miniGAP/minigap/results/librascal_distorted_propenols/force_prediction_plots.png' selected.
Filename '/home/sstafford/Documents/Python/miniGAP/minigap/results/librascal_distorted_propenols/force_errors.csv' selected.
