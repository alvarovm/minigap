Logging all output starting now into /home/sstafford/Documents/Python/miniGAP/minigap/results/Alcohol_12_06_2021/miniGAP.log
Input settings for this calculation stored in /home/sstafford/Documents/Python/miniGAP/minigap/results/Alcohol_12_06_2021/miniGAP.settings
Stack size set to unlimited
1 GPU(s) recognized by tensorflow: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Now generating MD trajectory of 600 C2H6O structures at 0 K using VelocityVerlet dynamics and the EMT calculator
Filename '/home/sstafford/Documents/Python/miniGAP/minigap/results/Alcohol_12_06_2021/C2H6O_VelocityVerlet.traj' selected.
Step 60: Energy per atom: Epot = 0.395eV  Ekin = 0.052eV  Etot = 0.447eV
Step 120: Energy per atom: Epot = 0.233eV  Ekin = 0.214eV  Etot = 0.447eV
Step 180: Energy per atom: Epot = 0.228eV  Ekin = 0.220eV  Etot = 0.447eV
Step 240: Energy per atom: Epot = 0.340eV  Ekin = 0.107eV  Etot = 0.447eV
Step 300: Energy per atom: Epot = 0.362eV  Ekin = 0.085eV  Etot = 0.447eV
Step 360: Energy per atom: Epot = 0.299eV  Ekin = 0.148eV  Etot = 0.447eV
Step 420: Energy per atom: Epot = 0.266eV  Ekin = 0.181eV  Etot = 0.447eV
Step 480: Energy per atom: Epot = 0.291eV  Ekin = 0.156eV  Etot = 0.447eV
Step 540: Energy per atom: Epot = 0.354eV  Ekin = 0.093eV  Etot = 0.447eV
Step 599: Energy per atom: Epot = 0.337eV  Ekin = 0.110eV  Etot = 0.447eV
Compiling structures into list took 2.74 seconds
Generating animation frame 0 (0% complete)
Generating animation frame 10 (10% complete)
Generating animation frame 20 (20% complete)
Generating animation frame 30 (30% complete)
Generating animation frame 40 (40% complete)
Generating animation frame 50 (50% complete)
Generating animation frame 60 (60% complete)
Generating animation frame 70 (70% complete)
Generating animation frame 80 (80% complete)
Generating animation frame 90 (90% complete)
Generating animation frame 100 (100% complete)
Filename '/home/sstafford/Documents/Python/miniGAP/minigap/results/Alcohol_12_06_2021/structure_animation.mp4' selected.
Generating animation frame 0 (0% complete)
Generating animation frame 10 (10% complete)
Generating animation frame 20 (20% complete)
Generating animation frame 30 (30% complete)
Generating animation frame 40 (40% complete)
Generating animation frame 50 (50% complete)
Generating animation frame 60 (60% complete)
Generating animation frame 70 (70% complete)
Generating animation frame 80 (80% complete)
Generating animation frame 90 (90% complete)
Generating animation frame 100 (100% complete)
Created animation of the structural dataset used in this calculation in the results directory. This might be useful to verify the correct structures are being used.
Created animation of structures in 4.421891689300537 seconds 
Gathered energy, force and structure info in 1.14 seconds
Completed the initial setup of miniGAP (including compiling structural data) in 10.87 seconds
Generated SOAP descriptors and derivatives in 9.70 seconds
Reformatted data to build model in 0.10 seconds.
Not using any sparsity.
Using a degree 2 polynomial kernel.
Alert: Double check the training validity for degree =/= 1 when not using predict_f
Training using 4374 atoms without batching.
Epoch 0
Using older approach (not converted to tf.function yet)
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| name                    | class            | transform        | prior   | trainable   | shape        | dtype   | value                                               |
+=========================+==================+==================+=========+=============+==============+=========+=====================================================+
| GPR.kernel.variance     | Parameter        | Softplus         |         | True        | ()           | float64 | 1.0126157723401579                                  |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.kernel.degree       | Parameter        | Identity         |         | False       | ()           | float64 | 2.0                                                 |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.kernel.offset       | Parameter        | Softplus         |         | False       | ()           | float64 | 2.2250738585072626e-308                             |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.likelihood.variance | Parameter        | Softplus + Shift |         | True        | ()           | float64 | 9.805396187885759e-05                               |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.data[0]             | ResourceVariable |                  |         | False       | (4374, 1500) | float64 | [[5.41216738e-01, 5.38103570e-01, 2.33632883e-01... |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.data[1]             | ResourceVariable |                  |         | False       | (4374, 1)    | float64 | [[0.75460675...                                     |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
Adding mse_ens_j_i to mse_ens_j: 0.0005718123717738021 + 0 = 0.0005718123717738021 
Epoch 0,  mse = 0.0005718123717738021
Using older approach (not converted to tf.function yet)
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-------------------------------------------------------+
| name                    | class            | transform        | prior   | trainable   | shape        | dtype   | value                                                 |
+=========================+==================+==================+=========+=============+==============+=========+=======================================================+
| GPR.kernel.variance     | Parameter        | Softplus         |         | True        | ()           | float64 | 1.025328831533566                                     |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-------------------------------------------------------+
| GPR.kernel.degree       | Parameter        | Identity         |         | False       | ()           | float64 | 2.0                                                   |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-------------------------------------------------------+
| GPR.kernel.offset       | Parameter        | Softplus         |         | False       | ()           | float64 | 2.2250738585072626e-308                               |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-------------------------------------------------------+
| GPR.likelihood.variance | Parameter        | Softplus + Shift |         | True        | ()           | float64 | 9.614411905607683e-05                                 |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-------------------------------------------------------+
| GPR.data[0]             | ResourceVariable |                  |         | False       | (4374, 1500) | float64 | [[4.23649801e-05, -2.14567914e-04, -1.22284457e-03... |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-------------------------------------------------------+
| GPR.data[1]             | ResourceVariable |                  |         | False       | (4374, 1)    | float64 | [[-0.1611096...                                       |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-------------------------------------------------------+
Adding mse_ens_j_i to mse_ens_j: 0.000552732693766834 + 0 = 0.000552732693766834 
Epoch 1,  mse = 0.000552732693766834
Epoch 2
Using older approach (not converted to tf.function yet)
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-------------------------------------------------------+
| name                    | class            | transform        | prior   | trainable   | shape        | dtype   | value                                                 |
+=========================+==================+==================+=========+=============+==============+=========+=======================================================+
| GPR.kernel.variance     | Parameter        | Softplus         |         | True        | ()           | float64 | 1.038117306078753                                     |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-------------------------------------------------------+
| GPR.kernel.degree       | Parameter        | Identity         |         | False       | ()           | float64 | 2.0                                                   |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-------------------------------------------------------+
| GPR.kernel.offset       | Parameter        | Softplus         |         | False       | ()           | float64 | 2.2250738585072626e-308                               |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-------------------------------------------------------+
| GPR.likelihood.variance | Parameter        | Softplus + Shift |         | True        | ()           | float64 | 9.427319358049835e-05                                 |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-------------------------------------------------------+
| GPR.data[0]             | ResourceVariable |                  |         | False       | (4374, 1500) | float64 | [[8.14726400e-06, -1.32582932e-05, -3.91075181e-04... |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-------------------------------------------------------+
| GPR.data[1]             | ResourceVariable |                  |         | False       | (4374, 1)    | float64 | [[-0.84487572...                                      |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-------------------------------------------------------+
Adding mse_ens_j_i to mse_ens_j: 0.0005342983272145558 + 0 = 0.0005342983272145558 
Epoch 2,  mse = 0.0005342983272145558
Using older approach (not converted to tf.function yet)
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-------------------------------------------------------+
| name                    | class            | transform        | prior   | trainable   | shape        | dtype   | value                                                 |
+=========================+==================+==================+=========+=============+==============+=========+=======================================================+
| GPR.kernel.variance     | Parameter        | Softplus         |         | True        | ()           | float64 | 1.0509668218604131                                    |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-------------------------------------------------------+
| GPR.kernel.degree       | Parameter        | Identity         |         | False       | ()           | float64 | 2.0                                                   |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-------------------------------------------------------+
| GPR.kernel.offset       | Parameter        | Softplus         |         | False       | ()           | float64 | 2.2250738585072626e-308                               |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-------------------------------------------------------+
| GPR.likelihood.variance | Parameter        | Softplus + Shift |         | True        | ()           | float64 | 9.244220413700084e-05                                 |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-------------------------------------------------------+
| GPR.data[0]             | ResourceVariable |                  |         | False       | (4374, 1500) | float64 | [[1.39594415e-05, -6.44330328e-05, -6.17928114e-04... |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-------------------------------------------------------+
| GPR.data[1]             | ResourceVariable |                  |         | False       | (4374, 1)    | float64 | [[0.71161147...                                       |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-------------------------------------------------------+
Adding mse_ens_j_i to mse_ens_j: 0.0005165177061818969 + 0 = 0.0005165177061818969 
Epoch 3,  mse = 0.0005165177061818969
Epoch 4
Using older approach (not converted to tf.function yet)
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| name                    | class            | transform        | prior   | trainable   | shape        | dtype   | value                                               |
+=========================+==================+==================+=========+=============+==============+=========+=====================================================+
| GPR.kernel.variance     | Parameter        | Softplus         |         | True        | ()           | float64 | 1.063864817076003                                   |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.kernel.degree       | Parameter        | Identity         |         | False       | ()           | float64 | 2.0                                                 |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.kernel.offset       | Parameter        | Softplus         |         | False       | ()           | float64 | 2.2250738585072626e-308                             |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.likelihood.variance | Parameter        | Softplus + Shift |         | True        | ()           | float64 | 9.065166937563012e-05                               |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.data[0]             | ResourceVariable |                  |         | False       | (4374, 1500) | float64 | [[5.47419702e-01, 5.24652639e-01, 2.33606053e-01... |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.data[1]             | ResourceVariable |                  |         | False       | (4374, 1)    | float64 | [[-0.65052344...                                    |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
Adding mse_ens_j_i to mse_ens_j: 0.0004993839862813949 + 0 = 0.0004993839862813949 
Epoch 4,  mse = 0.0004993839862813949
Using older approach (not converted to tf.function yet)
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| name                    | class            | transform        | prior   | trainable   | shape        | dtype   | value                                               |
+=========================+==================+==================+=========+=============+==============+=========+=====================================================+
| GPR.kernel.variance     | Parameter        | Softplus         |         | True        | ()           | float64 | 1.0767994214846268                                  |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.kernel.degree       | Parameter        | Identity         |         | False       | ()           | float64 | 2.0                                                 |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.kernel.offset       | Parameter        | Softplus         |         | False       | ()           | float64 | 2.2250738585072626e-308                             |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.likelihood.variance | Parameter        | Softplus + Shift |         | True        | ()           | float64 | 8.890186001111214e-05                               |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.data[0]             | ResourceVariable |                  |         | False       | (4374, 1500) | float64 | [[5.46831755e-01, 5.26566643e-01, 2.28248274e-01... |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.data[1]             | ResourceVariable |                  |         | False       | (4374, 1)    | float64 | [[-0.36672306...                                    |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
Adding mse_ens_j_i to mse_ens_j: 0.00048288583542731913 + 0 = 0.00048288583542731913 
Epoch 5,  mse = 0.00048288583542731913
Epoch 6
Using older approach (not converted to tf.function yet)
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------+
| name                    | class            | transform        | prior   | trainable   | shape        | dtype   | value                                   |
+=========================+==================+==================+=========+=============+==============+=========+=========================================+
| GPR.kernel.variance     | Parameter        | Softplus         |         | True        | ()           | float64 | 1.0897591303187424                      |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------+
| GPR.kernel.degree       | Parameter        | Identity         |         | False       | ()           | float64 | 2.0                                     |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------+
| GPR.kernel.offset       | Parameter        | Softplus         |         | False       | ()           | float64 | 2.2250738585072626e-308                 |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------+
| GPR.likelihood.variance | Parameter        | Softplus + Shift |         | True        | ()           | float64 | 8.719288382255085e-05                   |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------+
| GPR.data[0]             | ResourceVariable |                  |         | False       | (4374, 1500) | float64 | [[0.54733196, 0.50326513, 0.21026317... |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------+
| GPR.data[1]             | ResourceVariable |                  |         | False       | (4374, 1)    | float64 | [[0.66449643...                         |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------+
Adding mse_ens_j_i to mse_ens_j: 0.00046700978245062345 + 0 = 0.00046700978245062345 
Epoch 6,  mse = 0.00046700978245062345
Using older approach (not converted to tf.function yet)
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| name                    | class            | transform        | prior   | trainable   | shape        | dtype   | value                                               |
+=========================+==================+==================+=========+=============+==============+=========+=====================================================+
| GPR.kernel.variance     | Parameter        | Softplus         |         | True        | ()           | float64 | 1.1027327024779539                                  |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.kernel.degree       | Parameter        | Identity         |         | False       | ()           | float64 | 2.0                                                 |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.kernel.offset       | Parameter        | Softplus         |         | False       | ()           | float64 | 2.2250738585072626e-308                             |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.likelihood.variance | Parameter        | Softplus + Shift |         | True        | ()           | float64 | 8.552472315215035e-05                               |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.data[0]             | ResourceVariable |                  |         | False       | (4374, 1500) | float64 | [[5.41261842e-01, 5.27974309e-01, 3.25414106e-01... |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.data[1]             | ResourceVariable |                  |         | False       | (4374, 1)    | float64 | [[-0.26894783...                                    |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
Adding mse_ens_j_i to mse_ens_j: 0.00045174104483273683 + 0 = 0.00045174104483273683 
Epoch 7,  mse = 0.00045174104483273683
Epoch 8
Using older approach (not converted to tf.function yet)
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| name                    | class            | transform        | prior   | trainable   | shape        | dtype   | value                                               |
+=========================+==================+==================+=========+=============+==============+=========+=====================================================+
| GPR.kernel.variance     | Parameter        | Softplus         |         | True        | ()           | float64 | 1.1157091395383794                                  |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.kernel.degree       | Parameter        | Identity         |         | False       | ()           | float64 | 2.0                                                 |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.kernel.offset       | Parameter        | Softplus         |         | False       | ()           | float64 | 2.2250738585072626e-308                             |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.likelihood.variance | Parameter        | Softplus + Shift |         | True        | ()           | float64 | 8.389725510970104e-05                               |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.data[0]             | ResourceVariable |                  |         | False       | (4374, 1500) | float64 | [[5.34188463e-01, 5.47165910e-01, 2.32990726e-01... |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.data[1]             | ResourceVariable |                  |         | False       | (4374, 1)    | float64 | [[-0.03160667...                                    |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
Adding mse_ens_j_i to mse_ens_j: 0.00043706395456155866 + 0 = 0.00043706395456155866 
Epoch 8,  mse = 0.00043706395456155866
Using older approach (not converted to tf.function yet)
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| name                    | class            | transform        | prior   | trainable   | shape        | dtype   | value                                               |
+=========================+==================+==================+=========+=============+==============+=========+=====================================================+
| GPR.kernel.variance     | Parameter        | Softplus         |         | True        | ()           | float64 | 1.1286776980683577                                  |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.kernel.degree       | Parameter        | Identity         |         | False       | ()           | float64 | 2.0                                                 |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.kernel.offset       | Parameter        | Softplus         |         | False       | ()           | float64 | 2.2250738585072626e-308                             |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.likelihood.variance | Parameter        | Softplus + Shift |         | True        | ()           | float64 | 8.231026444610929e-05                               |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.data[0]             | ResourceVariable |                  |         | False       | (4374, 1500) | float64 | [[5.36543897e-01, 5.37570111e-01, 2.91387433e-01... |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
| GPR.data[1]             | ResourceVariable |                  |         | False       | (4374, 1)    | float64 | [[0.71197386...                                     |
+-------------------------+------------------+------------------+---------+-------------+--------------+---------+-----------------------------------------------------+
Adding mse_ens_j_i to mse_ens_j: 0.00042296219229092795 + 0 = 0.00042296219229092795 
Epoch 9,  mse = 0.00042296219229092795
Calculating weights
+-------------------------+-----------+------------------+---------+-------------+---------+---------+--------------+
| name                    | class     | transform        | prior   | trainable   | shape   | dtype   |        value |
+=========================+===========+==================+=========+=============+=========+=========+==============+
| GPR.kernel.variance     | Parameter | Softplus         |         | True        | ()      | float64 | 1.12868      |
+-------------------------+-----------+------------------+---------+-------------+---------+---------+--------------+
| GPR.kernel.degree       | Parameter | Identity         |         | False       | ()      | float64 | 2            |
+-------------------------+-----------+------------------+---------+-------------+---------+---------+--------------+
| GPR.kernel.offset       | Parameter | Softplus         |         | False       | ()      | float64 | 2.22507e-308 |
+-------------------------+-----------+------------------+---------+-------------+---------+---------+--------------+
| GPR.likelihood.variance | Parameter | Softplus + Shift |         | True        | ()      | float64 | 8.23103e-05  |
+-------------------------+-----------+------------------+---------+-------------+---------+---------+--------------+
Predicting final energies
Predicting final forces
Training time outside of epochs in training cell  : 0.873
Training time per epoch                           : 0.407
Prediction time                                   : 0.083
Stored the hyperparameters and mse values for plotting under n=600
The title axes are not assigned correctly. Currently fixing.
Our observation noise variance implies our reference error is +/- 0.000415 /atom
                         Local Energy  Global Energy
Root Mean Squared Error      0.000920       0.000688
Mean Absolute Error          0.000579       0.000435
Max Absolute Error           0.004810       0.002070
r²                           0.999833       0.999910
Least-squares regresion for Fx(x) produces the line line m x+b with m = 1.33523 and b = -1.41789 which has r2 = 0.53081 
Least-squares regresion for Fy(y) produces the line line m y+b with m = 1.29194 and b = -0.67063 which has r2 = 0.29566 
Least-squares regresion for Fz(z) produces the line line m z+b with m = 4.68599 and b = 0.00000 which has r2 = 0.90560 
