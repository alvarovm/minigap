Logging all output starting now into /home/sstafford/Documents/Python/miniGAP/minigap/results/Graphene_Fewer_12_06_2021/miniGAP.log
Input settings for this calculation stored in /home/sstafford/Documents/Python/miniGAP/minigap/results/Graphene_Fewer_12_06_2021/miniGAP.settings
Stack size set to unlimited
1 GPU(s) recognized by tensorflow: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Imported 60 structures from /home/sstafford/Documents/Python/miniGAP/minigap/data/ManyGraphenes_unzipped.db. Structures were taken uniformly from throughout dataset which contains 10000 total structures.
Compiling structures into list took 6.24 seconds
Generating animation frame 0 (0% complete)
Generating animation frame 10 (10% complete)
Generating animation frame 20 (20% complete)
Generating animation frame 30 (30% complete)
Generating animation frame 40 (40% complete)
Generating animation frame 50 (50% complete)
Generating animation frame 60 (60% complete)
Generating animation frame 70 (70% complete)
Generating animation frame 80 (80% complete)
Generating animation frame 90 (90% complete)
Generating animation frame 100 (100% complete)
Filename '/home/sstafford/Documents/Python/miniGAP/minigap/results/Graphene_Fewer_12_06_2021/structure_animation.mp4' selected.
Generating animation frame 0 (0% complete)
Generating animation frame 10 (10% complete)
Generating animation frame 20 (20% complete)
Generating animation frame 30 (30% complete)
Generating animation frame 40 (40% complete)
Generating animation frame 50 (50% complete)
Generating animation frame 60 (60% complete)
Generating animation frame 70 (70% complete)
Generating animation frame 80 (80% complete)
Generating animation frame 90 (90% complete)
Generating animation frame 100 (100% complete)
Created animation of the structural dataset used in this calculation in the results directory. This might be useful to verify the correct structures are being used.
Created animation of structures in 35.48285675048828 seconds 
Gathered energy and structure info in 1.19 seconds
Completed the initial setup of miniGAP (including compiling structural data) in 45.20 seconds
Generated SOAP descriptors in 0.41 seconds
Reformatted data to build model in 0.01 seconds.
Not using any sparsity.
Using a degree 2 polynomial kernel.
Alert: Double check the training validity for degree =/= 1 when not using predict_f
Training using 5443 atoms without batching.
Epoch 0
TRACING train_hyperparams_without_forces
TRACING train_hyperparams_without_forces
valid_ens[:3] = [ 1.24181188 -1.20942805 -1.47496084]
Adding mse_ens_j_i to mse_ens_j: 0.841990092065565 + 0 = 0.841990092065565 
Epoch 0,  mse = 0.841990092065565
valid_ens[:3] = [ 1.24181188 -1.20942805 -1.47496084]
Adding mse_ens_j_i to mse_ens_j: 0.8419431999162753 + 0 = 0.8419431999162753 
Epoch 1,  mse = 0.8419431999162753
Epoch 2
valid_ens[:3] = [ 1.24181188 -1.20942805 -1.47496084]
Adding mse_ens_j_i to mse_ens_j: 0.841900093362117 + 0 = 0.841900093362117 
Epoch 2,  mse = 0.841900093362117
valid_ens[:3] = [ 1.24181188 -1.20942805 -1.47496084]
Adding mse_ens_j_i to mse_ens_j: 0.8418609943806608 + 0 = 0.8418609943806608 
Epoch 3,  mse = 0.8418609943806608
Epoch 4
valid_ens[:3] = [ 1.24181188 -1.20942805 -1.47496084]
Adding mse_ens_j_i to mse_ens_j: 0.8418260198592196 + 0 = 0.8418260198592196 
Epoch 4,  mse = 0.8418260198592196
valid_ens[:3] = [ 1.24181188 -1.20942805 -1.47496084]
Adding mse_ens_j_i to mse_ens_j: 0.8417953654537017 + 0 = 0.8417953654537017 
Epoch 5,  mse = 0.8417953654537017
Epoch 6
valid_ens[:3] = [ 1.24181188 -1.20942805 -1.47496084]
Adding mse_ens_j_i to mse_ens_j: 0.8417688163935764 + 0 = 0.8417688163935764 
Epoch 6,  mse = 0.8417688163935764
valid_ens[:3] = [ 1.24181188 -1.20942805 -1.47496084]
Adding mse_ens_j_i to mse_ens_j: 0.8417463951328799 + 0 = 0.8417463951328799 
Epoch 7,  mse = 0.8417463951328799
Epoch 8
valid_ens[:3] = [ 1.24181188 -1.20942805 -1.47496084]
Adding mse_ens_j_i to mse_ens_j: 0.8417281226751837 + 0 = 0.8417281226751837 
Epoch 8,  mse = 0.8417281226751837
valid_ens[:3] = [ 1.24181188 -1.20942805 -1.47496084]
Adding mse_ens_j_i to mse_ens_j: 0.8417139110617541 + 0 = 0.8417139110617541 
Epoch 9,  mse = 0.8417139110617541
Calculating weights
+-------------------------+-----------+------------------+---------+-------------+---------+---------+--------------+
| name                    | class     | transform        | prior   | trainable   | shape   | dtype   |        value |
+=========================+===========+==================+=========+=============+=========+=========+==============+
| GPR.kernel.variance     | Parameter | Softplus         |         | True        | ()      | float64 | 1.12366      |
+-------------------------+-----------+------------------+---------+-------------+---------+---------+--------------+
| GPR.kernel.degree       | Parameter | Identity         |         | False       | ()      | float64 | 2            |
+-------------------------+-----------+------------------+---------+-------------+---------+---------+--------------+
| GPR.kernel.offset       | Parameter | Softplus         |         | False       | ()      | float64 | 2.22507e-308 |
+-------------------------+-----------+------------------+---------+-------------+---------+---------+--------------+
| GPR.likelihood.variance | Parameter | Softplus + Shift |         | True        | ()      | float64 | 8.28989e-05  |
+-------------------------+-----------+------------------+---------+-------------+---------+---------+--------------+
Predicting final energies
Training time outside of epochs in training cell  : 0.877
Training time per epoch                           : 0.594
Prediction time                                   : 0.064
Stored the hyperparameters and mse values for plotting under n=60
The title axes are not assigned correctly. Currently fixing.
Our observation noise variance implies our reference error is +/- 3.06e-05 /atom
                         Local Energy  Global Energy
Root Mean Squared Error      0.003438       0.003208
Mean Absolute Error          0.002833       0.002594
Max Absolute Error           0.008464       0.005396
rÂ²                           0.328812       0.842095
