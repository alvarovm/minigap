Logging all output starting now into /home/sstafford/Documents/Python/miniGAP/minigap/results/Water_12_06_2021/miniGAP.log
Input settings for this calculation stored in /home/sstafford/Documents/Python/miniGAP/minigap/results/Water_12_06_2021/miniGAP.settings
Stack size set to unlimited
1 GPU(s) recognized by tensorflow: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Now generating MD trajectory of 600 H2O structures at 0 K using VelocityVerlet dynamics and the EMT calculator
Filename '/home/sstafford/Documents/Python/miniGAP/minigap/results/Water_12_06_2021/H2O_VelocityVerlet.traj' selected.
Step 60: Energy per atom: Epot = 0.866eV  Ekin = 0.008eV  Etot = 0.873eV
Step 120: Energy per atom: Epot = 0.793eV  Ekin = 0.080eV  Etot = 0.873eV
Step 180: Energy per atom: Epot = 0.811eV  Ekin = 0.062eV  Etot = 0.873eV
Step 240: Energy per atom: Epot = 0.668eV  Ekin = 0.205eV  Etot = 0.873eV
Step 300: Energy per atom: Epot = 0.728eV  Ekin = 0.145eV  Etot = 0.873eV
Step 360: Energy per atom: Epot = 0.627eV  Ekin = 0.246eV  Etot = 0.873eV
Step 420: Energy per atom: Epot = 0.656eV  Ekin = 0.217eV  Etot = 0.873eV
Step 480: Energy per atom: Epot = 0.660eV  Ekin = 0.213eV  Etot = 0.873eV
Step 540: Energy per atom: Epot = 0.628eV  Ekin = 0.245eV  Etot = 0.873eV
Step 599: Energy per atom: Epot = 0.710eV  Ekin = 0.163eV  Etot = 0.873eV
Compiling structures into list took 1.58 seconds
Generating animation frame 0 (0% complete)
Generating animation frame 10 (10% complete)
Generating animation frame 20 (20% complete)
Generating animation frame 30 (30% complete)
Generating animation frame 40 (40% complete)
Generating animation frame 50 (50% complete)
Generating animation frame 60 (60% complete)
Generating animation frame 70 (70% complete)
Generating animation frame 80 (80% complete)
Generating animation frame 90 (90% complete)
Generating animation frame 100 (100% complete)
Filename '/home/sstafford/Documents/Python/miniGAP/minigap/results/Water_12_06_2021/structure_animation.mp4' selected.
Generating animation frame 0 (0% complete)
Generating animation frame 10 (10% complete)
Generating animation frame 20 (20% complete)
Generating animation frame 30 (30% complete)
Generating animation frame 40 (40% complete)
Generating animation frame 50 (50% complete)
Generating animation frame 60 (60% complete)
Generating animation frame 70 (70% complete)
Generating animation frame 80 (80% complete)
Generating animation frame 90 (90% complete)
Generating animation frame 100 (100% complete)
Created animation of the structural dataset used in this calculation in the results directory. This might be useful to verify the correct structures are being used.
Created animation of structures in 2.7190165519714355 seconds 
Gathered energy, force and structure info in 0.41 seconds
Completed the initial setup of miniGAP (including compiling structural data) in 7.05 seconds
Generated SOAP descriptors and derivatives in 0.70 seconds
Reformatted data to build model in 0.02 seconds.
Not using any sparsity.
Using a degree 2 polynomial kernel.
Alert: Double check the training validity for degree =/= 1 when not using predict_f
Training using 1458 atoms without batching.
Epoch 0
Using older approach (not converted to tf.function yet)
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| name                    | class            | transform        | prior   | trainable   | shape       | dtype   | value                                               |
+=========================+==================+==================+=========+=============+=============+=========+=====================================================+
| GPR.kernel.variance     | Parameter        | Softplus         |         | True        | ()          | float64 | 1.0114284488952932                                  |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.kernel.degree       | Parameter        | Identity         |         | False       | ()          | float64 | 2.0                                                 |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.kernel.offset       | Parameter        | Softplus         |         | False       | ()          | float64 | 2.2250738585072626e-308                             |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.likelihood.variance | Parameter        | Softplus + Shift |         | True        | ()          | float64 | 9.827888162043477e-05                               |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.data[0]             | ResourceVariable |                  |         | False       | (1458, 680) | float64 | [[5.41017156e-01, 5.38416384e-01, 2.26869577e-01... |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.data[1]             | ResourceVariable |                  |         | False       | (1458, 1)   | float64 | [[-1.20691531...                                    |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
Adding mse_ens_j_i to mse_ens_j: 1.7755737395646025e-05 + 0 = 1.7755737395646025e-05 
Epoch 0,  mse = 1.7755737395646025e-05
Using older approach (not converted to tf.function yet)
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| name                    | class            | transform        | prior   | trainable   | shape       | dtype   | value                                               |
+=========================+==================+==================+=========+=============+=============+=========+=====================================================+
| GPR.kernel.variance     | Parameter        | Softplus         |         | True        | ()          | float64 | 1.0232330534497227                                  |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.kernel.degree       | Parameter        | Identity         |         | False       | ()          | float64 | 2.0                                                 |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.kernel.offset       | Parameter        | Softplus         |         | False       | ()          | float64 | 2.2250738585072626e-308                             |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.likelihood.variance | Parameter        | Softplus + Shift |         | True        | ()          | float64 | 9.653158742848181e-05                               |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.data[0]             | ResourceVariable |                  |         | False       | (1458, 680) | float64 | [[5.46287961e-01, 5.32066162e-01, 2.11677183e-01... |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.data[1]             | ResourceVariable |                  |         | False       | (1458, 1)   | float64 | [[1.30524041...                                     |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
Adding mse_ens_j_i to mse_ens_j: 1.6865085540153396e-05 + 0 = 1.6865085540153396e-05 
Epoch 1,  mse = 1.6865085540153396e-05
Epoch 2
Using older approach (not converted to tf.function yet)
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| name                    | class            | transform        | prior   | trainable   | shape       | dtype   | value                                               |
+=========================+==================+==================+=========+=============+=============+=========+=====================================================+
| GPR.kernel.variance     | Parameter        | Softplus         |         | True        | ()          | float64 | 1.0352240110438318                                  |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.kernel.degree       | Parameter        | Identity         |         | False       | ()          | float64 | 2.0                                                 |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.kernel.offset       | Parameter        | Softplus         |         | False       | ()          | float64 | 2.2250738585072626e-308                             |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.likelihood.variance | Parameter        | Softplus + Shift |         | True        | ()          | float64 | 9.47943311759237e-05                                |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.data[0]             | ResourceVariable |                  |         | False       | (1458, 680) | float64 | [[5.43023021e-01, 5.36464720e-01, 2.19279926e-01... |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.data[1]             | ResourceVariable |                  |         | False       | (1458, 1)   | float64 | [[-1.07442745...                                    |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
Adding mse_ens_j_i to mse_ens_j: 1.5995262718129425e-05 + 0 = 1.5995262718129425e-05 
Epoch 2,  mse = 1.5995262718129425e-05
Using older approach (not converted to tf.function yet)
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| name                    | class            | transform        | prior   | trainable   | shape       | dtype   | value                                               |
+=========================+==================+==================+=========+=============+=============+=========+=====================================================+
| GPR.kernel.variance     | Parameter        | Softplus         |         | True        | ()          | float64 | 1.0473270949752311                                  |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.kernel.degree       | Parameter        | Identity         |         | False       | ()          | float64 | 2.0                                                 |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.kernel.offset       | Parameter        | Softplus         |         | False       | ()          | float64 | 2.2250738585072626e-308                             |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.likelihood.variance | Parameter        | Softplus + Shift |         | True        | ()          | float64 | 9.30801792852581e-05                                |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.data[0]             | ResourceVariable |                  |         | False       | (1458, 680) | float64 | [[5.37607987e-01, 5.37205655e-01, 2.70056904e-01... |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.data[1]             | ResourceVariable |                  |         | False       | (1458, 1)   | float64 | [[1.28385733...                                     |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
Adding mse_ens_j_i to mse_ens_j: 1.5162342960714845e-05 + 0 = 1.5162342960714845e-05 
Epoch 3,  mse = 1.5162342960714845e-05
Epoch 4
Using older approach (not converted to tf.function yet)
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+------------------------------------------------------+
| name                    | class            | transform        | prior   | trainable   | shape       | dtype   | value                                                |
+=========================+==================+==================+=========+=============+=============+=========+======================================================+
| GPR.kernel.variance     | Parameter        | Softplus         |         | True        | ()          | float64 | 1.0594980225435944                                   |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+------------------------------------------------------+
| GPR.kernel.degree       | Parameter        | Identity         |         | False       | ()          | float64 | 2.0                                                  |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+------------------------------------------------------+
| GPR.kernel.offset       | Parameter        | Softplus         |         | False       | ()          | float64 | 2.2250738585072626e-308                              |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+------------------------------------------------------+
| GPR.likelihood.variance | Parameter        | Softplus + Shift |         | True        | ()          | float64 | 9.13958826631191e-05                                 |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+------------------------------------------------------+
| GPR.data[0]             | ResourceVariable |                  |         | False       | (1458, 680) | float64 | [[8.49588308e-03, 1.17849645e-02, -3.24435812e-02... |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+------------------------------------------------------+
| GPR.data[1]             | ResourceVariable |                  |         | False       | (1458, 1)   | float64 | [[0.80961341...                                      |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+------------------------------------------------------+
Adding mse_ens_j_i to mse_ens_j: 1.4370709214726366e-05 + 0 = 1.4370709214726366e-05 
Epoch 4,  mse = 1.4370709214726366e-05
Using older approach (not converted to tf.function yet)
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| name                    | class            | transform        | prior   | trainable   | shape       | dtype   | value                                               |
+=========================+==================+==================+=========+=============+=============+=========+=====================================================+
| GPR.kernel.variance     | Parameter        | Softplus         |         | True        | ()          | float64 | 1.0717042647400774                                  |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.kernel.degree       | Parameter        | Identity         |         | False       | ()          | float64 | 2.0                                                 |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.kernel.offset       | Parameter        | Softplus         |         | False       | ()          | float64 | 2.2250738585072626e-308                             |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.likelihood.variance | Parameter        | Softplus + Shift |         | True        | ()          | float64 | 8.974556504848461e-05                               |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.data[0]             | ResourceVariable |                  |         | False       | (1458, 680) | float64 | [[5.38355247e-01, 5.39541798e-01, 2.45217409e-01... |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.data[1]             | ResourceVariable |                  |         | False       | (1458, 1)   | float64 | [[-0.93253077...                                    |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
Adding mse_ens_j_i to mse_ens_j: 1.3621486570677095e-05 + 0 = 1.3621486570677095e-05 
Epoch 5,  mse = 1.3621486570677095e-05
Epoch 6
Using older approach (not converted to tf.function yet)
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-------------------------------------------------------+
| name                    | class            | transform        | prior   | trainable   | shape       | dtype   | value                                                 |
+=========================+==================+==================+=========+=============+=============+=========+=======================================================+
| GPR.kernel.variance     | Parameter        | Softplus         |         | True        | ()          | float64 | 1.0839190930916653                                    |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-------------------------------------------------------+
| GPR.kernel.degree       | Parameter        | Identity         |         | False       | ()          | float64 | 2.0                                                   |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-------------------------------------------------------+
| GPR.kernel.offset       | Parameter        | Softplus         |         | False       | ()          | float64 | 2.2250738585072626e-308                               |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-------------------------------------------------------+
| GPR.likelihood.variance | Parameter        | Softplus + Shift |         | True        | ()          | float64 | 8.813197420757705e-05                                 |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-------------------------------------------------------+
| GPR.data[0]             | ResourceVariable |                  |         | False       | (1458, 680) | float64 | [[1.35053488e-06, -2.28615606e-04, -6.87191043e-06... |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-------------------------------------------------------+
| GPR.data[1]             | ResourceVariable |                  |         | False       | (1458, 1)   | float64 | [[0.53080106...                                       |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-------------------------------------------------------+
Adding mse_ens_j_i to mse_ens_j: 1.2914434107056131e-05 + 0 = 1.2914434107056131e-05 
Epoch 6,  mse = 1.2914434107056131e-05
Using older approach (not converted to tf.function yet)
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| name                    | class            | transform        | prior   | trainable   | shape       | dtype   | value                                               |
+=========================+==================+==================+=========+=============+=============+=========+=====================================================+
| GPR.kernel.variance     | Parameter        | Softplus         |         | True        | ()          | float64 | 1.096119168065669                                   |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.kernel.degree       | Parameter        | Identity         |         | False       | ()          | float64 | 2.0                                                 |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.kernel.offset       | Parameter        | Softplus         |         | False       | ()          | float64 | 2.2250738585072626e-308                             |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.likelihood.variance | Parameter        | Softplus + Shift |         | True        | ()          | float64 | 8.655701658047025e-05                               |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.data[0]             | ResourceVariable |                  |         | False       | (1458, 680) | float64 | [[5.53336677e-01, 5.16316931e-01, 2.09241197e-01... |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.data[1]             | ResourceVariable |                  |         | False       | (1458, 1)   | float64 | [[1.05023979...                                     |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
Adding mse_ens_j_i to mse_ens_j: 1.2248611346063535e-05 + 0 = 1.2248611346063535e-05 
Epoch 7,  mse = 1.2248611346063535e-05
Epoch 8
Using older approach (not converted to tf.function yet)
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-------------------------------------------------------+
| name                    | class            | transform        | prior   | trainable   | shape       | dtype   | value                                                 |
+=========================+==================+==================+=========+=============+=============+=========+=======================================================+
| GPR.kernel.variance     | Parameter        | Softplus         |         | True        | ()          | float64 | 1.108283437276149                                     |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-------------------------------------------------------+
| GPR.kernel.degree       | Parameter        | Identity         |         | False       | ()          | float64 | 2.0                                                   |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-------------------------------------------------------+
| GPR.kernel.offset       | Parameter        | Softplus         |         | False       | ()          | float64 | 2.2250738585072626e-308                               |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-------------------------------------------------------+
| GPR.likelihood.variance | Parameter        | Softplus + Shift |         | True        | ()          | float64 | 8.502202311034018e-05                                 |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-------------------------------------------------------+
| GPR.data[0]             | ResourceVariable |                  |         | False       | (1458, 680) | float64 | [[5.69980232e-05, -1.39981342e-03, -3.37665148e-04... |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-------------------------------------------------------+
| GPR.data[1]             | ResourceVariable |                  |         | False       | (1458, 1)   | float64 | [[1.408309...                                         |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-------------------------------------------------------+
Adding mse_ens_j_i to mse_ens_j: 1.1622679024621668e-05 + 0 = 1.1622679024621668e-05 
Epoch 8,  mse = 1.1622679024621668e-05
Using older approach (not converted to tf.function yet)
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| name                    | class            | transform        | prior   | trainable   | shape       | dtype   | value                                               |
+=========================+==================+==================+=========+=============+=============+=========+=====================================================+
| GPR.kernel.variance     | Parameter        | Softplus         |         | True        | ()          | float64 | 1.1203925975998754                                  |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.kernel.degree       | Parameter        | Identity         |         | False       | ()          | float64 | 2.0                                                 |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.kernel.offset       | Parameter        | Softplus         |         | False       | ()          | float64 | 2.2250738585072626e-308                             |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.likelihood.variance | Parameter        | Softplus + Shift |         | True        | ()          | float64 | 8.352789736305293e-05                               |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.data[0]             | ResourceVariable |                  |         | False       | (1458, 680) | float64 | [[5.39409016e-01, 5.39411563e-01, 2.35944338e-01... |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
| GPR.data[1]             | ResourceVariable |                  |         | False       | (1458, 1)   | float64 | [[-0.70025456...                                    |
+-------------------------+------------------+------------------+---------+-------------+-------------+---------+-----------------------------------------------------+
Adding mse_ens_j_i to mse_ens_j: 1.1035059356495266e-05 + 0 = 1.1035059356495266e-05 
Epoch 9,  mse = 1.1035059356495266e-05
Calculating weights
+-------------------------+-----------+------------------+---------+-------------+---------+---------+--------------+
| name                    | class     | transform        | prior   | trainable   | shape   | dtype   |        value |
+=========================+===========+==================+=========+=============+=========+=========+==============+
| GPR.kernel.variance     | Parameter | Softplus         |         | True        | ()      | float64 | 1.12039      |
+-------------------------+-----------+------------------+---------+-------------+---------+---------+--------------+
| GPR.kernel.degree       | Parameter | Identity         |         | False       | ()      | float64 | 2            |
+-------------------------+-----------+------------------+---------+-------------+---------+---------+--------------+
| GPR.kernel.offset       | Parameter | Softplus         |         | False       | ()      | float64 | 2.22507e-308 |
+-------------------------+-----------+------------------+---------+-------------+---------+---------+--------------+
| GPR.likelihood.variance | Parameter | Softplus + Shift |         | True        | ()      | float64 | 8.35279e-05  |
+-------------------------+-----------+------------------+---------+-------------+---------+---------+--------------+
Predicting final energies
Predicting final forces
Training time outside of epochs in training cell  : 0.727
Training time per epoch                           : 0.129
Prediction time                                   : 0.028
Stored the hyperparameters and mse values for plotting under n=600
The title axes are not assigned correctly. Currently fixing.
Our observation noise variance implies our reference error is +/- 0.000788 /atom
                         Local Energy  Global Energy
Root Mean Squared Error      0.000284       0.000251
Mean Absolute Error          0.000200       0.000197
Max Absolute Error           0.000905       0.000642
r²                           0.999995       0.999996
/home/sstafford/anaconda3/envs/minigap/lib/python3.9/site-packages/numpy/lib/polynomial.py:659: RuntimeWarning: invalid value encountered in true_divide
  lhs /= scale
Least-squares regresion for Fy(y) produces the line line m y+b with m = 1.86642 and b = 0.00000 which has r2 = 0.99935 
Least-squares regresion for Fz(z) produces the line line m z+b with m = 1.29134 and b = 0.20313 which has r2 = 0.95306 
